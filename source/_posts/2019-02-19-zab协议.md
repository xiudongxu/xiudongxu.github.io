---
title: zab协议
date: 2019-02-03 21:40:20
tags: zab协议
categories: 分布式一致性协议
copyright: false
---

zab协议  全称 zookeeper atomic brodcast  原子广播协议

zookeeper 通过此协议来保证分布式事务的最终一致性的

[zab协议](https://www.jianshu.com/p/2bceacd60b8a)



Zab协议原理

zab协议要求每个Leader都要经历三个阶段：发现，同步，广播

发现：要求zookeeper集群必须选举出一个Leader进程，同时Leader会维护一个Follower可用客户端列表。

同步：Leader要负责将本身的数据与Follower完成同步，做到多副本存储。这样也是体现了CAP中的高可用和分区容错。

广播：Leader可以接受客户端新的事务Proposal请求，将新的Proposal请求广播给所有的Follower





zab协议有两种模式：消息广播模式 和 崩溃恢复模式

消息广播：

只要有一台服务器提交了Proposal 就要确保所有的服务器最终都能正确提交Proposal 这也是CAP/BASE 实现最终一致性的一个体现。

Leader服务器与每一个Follower服务器之间都维护了一个单独的FIFO消息队列进行收发消息，使用队列消息可以做到异步解耦。Leader和Follower之间只需要往队列中发消息即可。

崩溃恢复：

